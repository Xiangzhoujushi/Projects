<html>
<head>
<style type="text/css">
	#problem6 svg {
			/*width: 1500px;
			height:1500px;*/

	}

</style>

<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>	
	// $(document).ready(function(e){
	// 		
	// 	});
d3.csv("out5_1.csv",initiate1, processingProblem6);
			// d3.csv("out5.2.csv", initiate, processingProblem6);
			// d3.csv("out5.3.csv", initiate, processingProblem6);
			// d3.csv("out5.4.csv", initiate, processingProblem6);
			// d3.csv("out5.4.csv", initiate, processingProblem6);

function initiate1(d){

					// var val;
					result ={}
					
					for (var key in d){
						console.log(d);
						new_key = key;
						if(key!='Item'){
						new_key = 'value';
						result[new_key] = d[key];						
						}
					}
					console.log(result);
					// switch(d.keys[1]){
					// 	val = d[keys]
					// }

					// result = [{Item: d.Item},
					// {name: 'Lowest 20 Percent', value: +d["Lowest 20 percent"]},
					// {name: 'Second 20 Percent', value: +d["Second 20 percent"]},
					// {name: 'Third 20 Percent', value: +d["Third 20 percent"]},
					// {name: 'Fourth 20 Percent',value : +d["Fourth 20 percent"]},
					// {name: 'Highest 20 Percent', value: +d["Highest 20 percent"]}
					// ];
					// incomeWithExpenditure.push(result);
					return d;
} 	

function processingProblem6(error,data){

			if (error) throw error;
			 
			var color = d3.scaleOrdinal(["#3366cc", "#dc3912", "#ff9900", "#109618", "#990099"]);
			 // the patter of the data should be an array of {name: Income groups, value: value of expenditures}
			 var height_size= 25;
			 var interval_size =28;
			 var scale = 300;
			 var bar_factor = 0.3;
			 // var yCoord*28+60
			 // data of values;
			// data.sort(function (a,b) { return b.value - a.value;})
			var shift_graph = [100,800]
			var svg = d3.select('#problem6').append('svg')
			.attr("width", 1500)
			.attr("height", 1500)
			.style('background','#ffffff')
			;

			//create a title
			// svg.append('<h4>'+Object.keys(data[0])+'</h4>');


			var graph_bar = svg.append('g')
			.attr("transform","translate("+shift_graph[0]+","+shift_graph[1]+")")
			;
			// graph.append
			graph_bar.selectAll('rect')		
			
			.data(data).enter().append('rect')
			.attr('y',function (d,i){
				return (interval_size)*i;
			})
			.attr('x',0)
			.attr('width',function(d){
				d.value*bar_factor;
			})
			.attr('height',height_size)	
			.style('fill', function(d,i){
				//get the same color, initially
				return color(0);
			})
			;

			// append text 
			graph_bar.selectAll('text').data(data).enter().append("text")
			.attr('text-anchor','left')
			.text(function(d,i){
				return i;
			}
			).attr("transform",function(d,i){
				var yCoord = shift_graph[0]+ interval_size*i
				var result = "translate("+50+","+yCoord+")"
				return result;
			})
			;


			//create a mapping lists from value to data
			var graph_tag = svg.append('g');

			graph_tag.selectAll('text').data(data).enter()
			.append("text")
			.attr("transform","translate("+shift_graph[0]+","+30+")")
			.attr('text-anchor','left')
			.text(function(d,i){
				// map from index to value
				return i+": "+d.Item;
			}
			).attr("transform",function(d,i){
				var yCoord = shift_graph[0]+ interval_size*i
				var result = "translate("+50+","+yCoord+")"
				return result;
			});


			// find the 
			// find the max of the data
			// var max = data.reduce(function(a, b) {
   //  		return Math.max(a.value, b.value);
			// });
			// .attr('x',function(d,i){
			// 	// align it to the right hand side.
			// 	return (180-d.value*scale)+i*180+20;
			// var scaler= d3.scaleLinear().domain([0,max+0.1*max]).range([scale,0]);
			// var yaxis = d3.axisLeft().scale(scaler);	
			// d3.select('#problem6').append('svg').append('g').call(axis).attr("transform", "translate(" +600+ "," +600+ ")").select('path')
			
			// y-axis
			// then draw x-axis			
			// });
}
</script>

</head>

<body>

	<div id="problem6">

		<!-- <svg></svg>

		<svg></svg> -->

</body>
</html>